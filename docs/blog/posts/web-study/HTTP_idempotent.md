---
draft: false
authors:
  - hyewon
date: 2024-01-03
categories:
  - Study
  - Web
  - HTTP
---
# HTTP 멱등성
> HTTP Request Method의 멱등성에 대해 알아보기
<!-- more -->
## 멱등성(Idempotency)이란?
- 프로그래밍과 수학에서 널리 사용되는 개념으로 연산을 여러 번 적용하더라도 결과가 달라지지 않는 성질을 의미한다.
- HTTP 메서드가 멱등하다는 것은 클라이언트가 동일한 요청을 여러 번 보내더라도 서버의 상태가 동일하게 유지되는 것을 의미한다.  
- 첫 번째 요청에서 변화가 있을 수 있지만, 동일한 요청을 반복했을 때 추가적인 변화가 없으면 그 메서드는 멱등한 것으로 간주된다. 즉, <span style="background-color:#fff5b1">서버의 상태가 "최종적으로" 어떻게 변화하는지</span>에 초점을 맞춘다. 

## ⭐️ 멱등성 필요성

멱등성이 필요한 이유는 <span style="background-color:#fff5b1">요청의 재시도</span> 떄문이다.     
예를들어, 내가 get메서드를 통해 naver를 호출 했을 때 에러가 발생가면, 컴퓨터는 자동으로 naver에게 다시 GET 메서드를 호출 하도록 프로그래밍 할 수 있다. GET이 멱등성을 가지고 있기 때문에 동일한 요청을 여러 번 하더라도 서버의 상태나 반환되는 데이터에 변화가 없기 때문이다.  

반면 naver blog에 게시글을 작성후 등록 버튼을 눌렀을 때, 에러가 난 경우에 무작정 컴퓨터가 재시도를 하게 두면 안된다. 왜냐하면 POST는 멱등하지 않기 때문에 POST 요청을 반복하면 서버의 상태가 여러 번 변경될 수 있다. 즉 게시글 등록 요청을 재시도 하면 같은 내용의 게시글이 여러번 등록될 수 있다.  
이를 방지하기 위해, 서버에 대한 요청을 실패하여 재시도 로직을 구현 시, 사용자에게 재시도 여부를 묻거나 서버 측에서 중복 요청을 감지하고 처리할 수 있는 메커니즘을 구현하는 방법이 있다.

## 멱등성 요약

| HTTP 메서드 | 멱등성 여부 | 목적 | 이유 |  
|:-----------:|:-----------------:|:-----------------:|:-----------------:|
| GET         |         O         |    리소스 조회    | 같은 요청을 N번 호출해도 시스템으로부터 같은 결과 조회됨 |
| POST        |         X         |    리소스 생성    | 같은 요청을 N번 호출하면 새로운 리소스 생성 되면서 호출 결과가 달라질 수 있음 |
| PUT         |         O         |    리소스 대체    | 같은 요청을 N번 호출해도 항상 대상 리소스를 대체하여 동일한 상태로 만듦 |
| DELETE      |         O         |    리소스 삭제    | N번 호출해도 항상 리소스가 없는 동일한 상태 |
| PATCH       |         X         |    리소스 수정    | 기존 리소스에 응답을 추가하는 경우에 사용되며, 호출 결과가 달라질 수 있음 |


  
### ⭕️ 멱등한 HTTP 메서드

1. **GET**
    - 서버의 데이터를 읽기만 하므로, 요청을 반복해도 서버의 상태에 변화가 없다.
    - [예시] 사용자 프로필 페이지를 여러 번 조회하더라도 서버의 데이터는 변하지 않는다.
2. **PUT**
    - 동일한 리소스에 대한 PUT 요청을 여러 번 수행해도, 서버의 해당 리소스 상태는 마지막 PUT 요청의 상태를 반영한다.  
    - [예시] 사용자의 이메일 주소를 동일한 값으로 여러 번 업데이트해도 결과는 동일하게 유지된다.
    - 123 -> 456 -> 456
3. **DELETE**
    - 한 번 삭제된 리소스에 대해 DELETE 요청을 반복해도, 리소스는 이미 삭제된 상태이므로 서버의 상태가 변하지 않는다.
    - [예시] 특정 게시글을 삭제한 후, 같은 DELETE 요청을 다시 보내도 게시글은 이미 삭제된 상태이므로 추가적인 변화는 없다.

### ❌ 멱등하지 않은 HTTP 메서드
1. **POST**  
    - POST 메서드는 서버에 새로운 리소스를 생성한다. 동일한 POST 요청을 여러 번 수행하면, 서버에 같은 데이터의 복사본이 여러 개 생성될 수 있다. 따라서 POST는 멱등하지 않다.     
    - [예시] 같은 내용의 댓글(동일한 요청)을 다시 서버에 보내면 서버는 이 요청을 새로운 댓글로 인식하고, 데이터베이스에 또 다른 댓글로 저장하게 된다.

2. **PATCH**
    - PATCH 메서드는 리소스의 일부를 수정합니다. 같은 PATCH 요청을 여러 번 수행하면, 각 요청이 서버의 상태에 영향을 미칠 수 있다.
    - [예시] 기존 내용에 추가적으로 append 한다. 
    - 123 -> 123456 -> 123456456

<br>
<br>
<br>
<br>
<br>