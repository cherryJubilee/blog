---
draft: false
authors:
    - hyewon
date: 2024-06-17
categories:
    - java
---

# 스트림(Strem) - 함수형 프로그래밍

> 함수형 프로그래밍 - 스트림

<!-- more -->

## 📌 스트림(Stream)

1. 자료가 모여 있는 배열이나 컬렉션 또는 특정 범위 안에 있는 일련의 숫자를 처리하는 기능 구현
2. 배열 요소를 특정 기분에 따라 정렬(sorting)하거나, 요소 중 특정 값은 제외하고 출력하는 (filter) 기능
3. 여러 자료의 처리에 대한 기능을 구현해 놓은 클래스가 stream이다.
4. 자료의 대상과 관계없이 동일한 연산을 수행
5.

<details>
<summary> 스트림 예제 </summary>

```java
public class IntArratStreamTest {

	public static void main(String[] args) {
		// 정수 5개를 요소로 가진 배열, 이름 모두 출력
		int[] arr = { 1, 2, 3, 4, 5 };
		for (int a : arr)
			System.out.print(a + "\t");
		System.out.println();

		// 이 배열에 대한 스트림을 생성하여 출력
		Arrays.stream(arr).forEach(n-> System.out.print(n + "\t"));
		// --------------  ----------------------------------------
		// 스트림 객체 생성     요소를 하나씩 꺼내서 출력 하는 기능
	}
}

```

```bash
1	2	3	4	5
1	2	3	4	5
```

</details>

## 📌 스트림 연산

1. 중간 연산
    - 자료를 거르거나 변경하여 또 다른 자료를 내부적으로 생성함
2. 최종 연산
    - 생성된 내부 자료를 소모해 가면서 연산을 수행
    - 마지막에 한 번만 호출됨
    - 최종 연산이 호출되어야 중간 연산의 결과가 만들어 짐.
        - 중간 연산에 대한 결과를 연산 중에 알 수 없음
        - 이를 `지연 연산`이라고 함

### 💡 중간 연산

1. `filter()`

    - 조건을 넣고 그 조건에 맞는 참인 경우만 추출하는 경우에 사용

2. `map()`

    - 클래스가 가진 자료 중 이름만 출력하는 경우에 사용

3. `sorted()`

### 💡 최종 연산

1. 스크림의 자료를 소모하면서 연산을 수행하기 때문에 최종 연산이 수행되고 나면 해당 스트림은 더이상 사용할 수 없음
2. 최종 연산은 결과를 만드는데 주로 사용함
3. `forEach()`
    - 요소를 하나씩 꺼내는 기능
4. `sum()`, `count()`

<details>
<summary> 중간 연산, 최종 연산 예제 2가지 </summary>

```java
package kr.co.kosta;

import java.util.Arrays;

public class IntArratStreamTest {

    public static void main(String[] args) {
    	// 정수 5개를 요소로 가진 배열, 이름 모두 출력
    	int[] arr = { 1, 2, 3, 4, 5 };
    	for (int a : arr)
    		System.out.print(a + "\t");
    	System.out.println();

    	// 이 배열에 대한 스트림을 생성하여 출력
    	Arrays.stream(arr).forEach(n -> System.out.print(n + "\t"));
    	// -------------- ----------------------------------------
    	// 스트림 객체 생성 요소를 하나씩 꺼내서 출력 하는 기능

    	System.out.println();
    }
}

```

```bash
1	2	3	4	5
1	2	3	4	5
```

```java
package kr.co.kosta;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Stream;

public class IntAttayStreamTest2 {

	public static void main(String[] args) {

		int[] arr = { 1, 2, 3, 4, 5 };
		int sumValue = (int) Arrays.stream(arr).sum(); // 정수 배열에 스트림 활용
		int count = (int) Arrays.stream(arr).count();

		System.out.println(sumValue);  // 15
		System.out.println(count);  // 5

		List<String> sList = new ArrayList<>();
		sList.add("이순신");
		sList.add("나대용 구선 제작자");
		sList.add("권율");

		Stream<String> stream = sList.stream();
		stream.forEach(s -> System.out.print(s + "\t"));
		System.out.println();

		sList.stream().sorted().forEach(n -> System.out.print(n + "\t"));
		System.out.println();

		sList.stream().filter(s -> s.length() >= 7).forEach(n -> System.out.print(n + "\t"));
		System.out.println();
	}
}
```

</details>

## 📌 배열을 스트림으로 변환하기

-   배열의 원소들을 스트림 형태로 변환하여 처리할 수 있게됨
-   인덱스를 통한 직접 접근은 제공하지 않음
-   스트림은 데이터 처리 작업을 연속적인 파이프라인으로 나타낼 수 있어 가독성이 높고, 병렬 처리를 쉽게 구현 가능하다.

> Collectors 클래스

-   Collector 인터페이스의 다양한 구현체를 제공하는 유틸리티 클래스
-   스트림의 요소들을 리스트, 세트, 맵 등으로 수집하거나 그룹화, 분할, 결합 등의 작업을 수행할 수 있는 메서드를 제공
    -   `toList()`: 스트림의 요소를 리스트로 수집
    -   `toSet()`: 스트림의 요소를 세트로 수집
    -   `toMap()`: 스트림의 요소를 맵으로 수집

주요 메서드 예시:

toList(): 스트림의 요소를 리스트로 수집합니다.
toSet(): 스트림의 요소를 세트로 수집합니다.
toMap(): 스트림의 요소를 맵으로 수집합니다.
joining(): 스트림의 문자열 요소를 하나의 문자열로 결합합니다.
groupingBy(): 스트림의 요소를 그룹화하여 맵으로 수집합니다.
partitioningBy(): 스트림의 요소를 조건에 따라 두 그룹으로 분할하여 맵으로 수집합니다.

<details>
<summary> 배열을 스트림으로 변환하기 </summary>

```java
package kr.co.kosta;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class IntAttayStreamTest3 {

	public static void main(String[] args) {

		// 방법 1. Stream.of() 메서드를 이용해 스트림 객체를 생성
        Stream<String> strStream = Stream.of("곧 6월의 끝이", "다가오고 있습니다", "벌써 시간이 그렇게 되었네요");
        // 스트림 -> 리스트로 변환하여 저장
        List<String> str = strStream.collect(Collectors.toList());
        System.out.println(str);


        // 방법 2. 배열과 Arrays.stream()을 사용한 스트림 생성
        String[] cityArray = new String[] { "서울", "뉴욕", "파리" };
        // Arrays.stream() 메서드를 이용해 배열 -> 스트림으로 변환
        Stream<String> cityStream = Arrays.stream(cityArray);

        // 스트림 -> 리스트로 변환하여 저장
        List<String> cityList = cityStream.collect(Collectors.toList());
        System.out.println(cityList);
	}
}

```

</details>

> 차이점

1. `Stream.of()`: 여러 인자를 받아 스트림을 직접 생성. 인자가 여러 개일 때 유용
2. `Arrays.stream()`: 이미 존재하는 배열을 스트림으로 변환. 배열이 존재할 때 유용

<br>

## 📌 함수형 인터페이스 메서드 참조

코드의 중복을 줄이는데 도움이 됨

1. 정적 메서드 참조

    > `class명::메서드명`

    ```java
    public class IntegerUtilsTest {

        public static void main(String[] args) {

            // 정적메서드 참조
            // Converter<String, Integer> converter = s -> IntegerUtils.stringToInt(s);
            Converter<String, Integer> converter = IntegerUtils::stringToInt;
            int result = converter.convert("1234");
            System.out.println("result = " + result);  // result = 1234
        }
    }

    ```

2. 인스턴스 메서드 참조

    > `인스턴스::메서드명`

    ```java
    public class StringUtilsTest {

        public static void main(String[] args) {

            StringUtils stringUtils = new StringUtils();
            // Converter<String, String> converter = s -> stringUtils.reverse(s);
            Converter<String, String> converter = stringUtils::reverse;
            String result = converter.convert("hello");
            System.out.println("result : " + result); //result : olleh
        }
    }

    ```

3. 특정 객체의 인스턴스 메서드 참조

    > 클래스명::메서드명

    ```java
    // 예제1
    public class MethodReferenceTest {

        public static void main(String[] args) {
            List<String> names = Arrays.asList("홍길동", "신사임당", "이순신");

            // string 클래스의 메서드 참조
            // Collections.sort(names, (s1, s2) -> s1.compareTo(s2));
            Collections.sort(names, String::compareTo);
            System.out.println(names);
        }
    }
    ```

    ```java
    //예제 2
    package kr.co.kosta4;

    class Product {
        private String name;
        private int quantity;

        public Product(String name, int quantity) {
            super();
            this.name = name;
            this.quantity = quantity;
        }

        public int getQuantity() {
            return quantity;
        }

    }

    public class StreamTest {

        public static void main(String[] args) {

            List<Product> products =
                    Arrays.asList(new Product("ipad Pro M4", 1), new Product("Magic Keyboard", 2));
            int totalQuantity = products.stream().mapToInt(Product::getQuantity).sum();
            System.out.println("전체 총 합 : "+totalQuantity);  // 전체 총 합:  3
        }
    }

    ```

4. 생성자 참조

    > 클래스명::new

    ```java
    package kr.co.kosta3;

    public class Person {

        private String name;
        private int age;

        public Person() {}

        public Person(String name, int age) {
            super();
            this.name = name;
            this.age = age;
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }

        public int getAge() {
            return age;
        }

        public void setAge(int age) {
            this.age = age;
        }

        @Override
        public String toString() {
            return "Person name=" + name + ", age=" + age ;
        }

    }

    ```

    ```java
    package kr.co.kosta3;

    @FunctionalInterface
    public interface PersonBirth {

        public Person born(String name, int age);
    }
    ```

    ```java
    package kr.co.kosta3;

    public class PersonBirthTest {

        public static void main(String[] args) {

            // 익명 내부 클래스
            PersonBirth personBirth = new PersonBirth() {

                @Override
                public Person born(String name, int age) {

                    return new Person(name, age);
                }
            };

            Person person = personBirth.born("홍길동", 33);
            System.out.println(person);

            PersonBirth personBirth2 =  Person::new;
            Person person2 =  personBirth2.born("shin", 22);
            System.out.println(person2);
        }
    }

    ```

### 🍀 스트림 미니 구현 해보기

> StreamTest - kosta5

1. 패키지 여행을 떠나는 고객이 있습니다.
2. 여행 비용은 15세 이상은 100만원, 그 미만은 50만원 입니다.
3. 고객 3명이 패키지 여행을 갑니다.
4. 이때 비용 계산과 고객 명단 검색 등을 구현하시오. (스트림 활용)

<details>
<summary> 🍀 스트림 예제 1</summary>

```java

```

```java

```

```bash

```

</details>
