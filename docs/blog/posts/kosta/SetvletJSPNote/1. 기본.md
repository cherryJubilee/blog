---
draft: false
authors:
    - hyewon
date: 2024-07-22
categories:
    - Backend
---

# servlet

<!-- more -->

## ğŸ ì›¹ í˜ì´ì§€(ì •ì  & ë™ì )

1. static Web Page
    - ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼ ê·¸ëŒ€ë¡œ ì›¹ ë¸Œë¼ìš°ì €ì— ì „ì†¡í•´ ì¶œë ¥í•˜ëŠ” ì›¹ í˜ì´ì§€ (ì„œë²„ê°€ ê°–ê³ ìˆìŒ)
    - í•­ìƒ ë™ì¼í•œ ëª¨ìŠµ(ì •ì )
2. dynamic Web Page
    - ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ í•´ì„í•˜ì—¬ ê°€ì¥ ì ì ˆí•œ ì›¹ í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤€ë‹¤.

## ì„œë¸”ë¦¿ (servlet + let)

1. ì„œë²„ ì¸¡ì—ì„œ ì‹¤í–‰ë˜ëŠ” ìë°” í”„ë¡œê·¸ë¨
2. í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìœ¼ë©´ ì„œë²„ì—ì„œ ì²˜ë¦¬ í•œ í›„, ê²°ê³¼ë¥¼ ì‘ë‹µìœ¼ë¡œ ê²°ê³¼ê°’ì„ ë³´ë‚´ì£¼ëŠ” êµ¬ì¡°
   ![web,wasê·¸ë¦¼](img/image.png)

3. êµ¬ì¡°

    - ì›¹ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)
    - WAS(Seb Server, Servlet Container + JSP ì—”ì§„ (Tomcat))

## ğŸ JSP

1. ì„œë¸”ë¦¬ë¦¿ì˜ ë‹¨ì ì„ ë³´ì™„í•´ì„œ ë‚˜ì˜´
2. ì„œë¸”ë¦¿ì€ ê¸°ë³¸ì ìœ¼ë¡œ ìë°” ì½”ë“œì´ë‹¤. - ê²°ê³¼ë¡œ ë³´ì—¬ì¤„ HTML ì½”ë“œë¥¼ ë§Œë“œëŠ”ë° ë„ˆë¬´ ë§ìœ¼ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤.
3. êµ¬ì¡°
   ![alt text](img/image2.png)

## ğŸ Servlet ì˜ë¯¸

1.  Servletì€ JSPê°€ ë‚˜ì˜¤ê¸° ì „, ìë°”ë¡œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ ê°œë°œí•  ìˆ˜ ìˆëŠ” ê¸°ìˆ 
2.  ì„œë²„ ë‹¨ì—ì„œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ì•„ ì²˜ë¦¬í•œ í›„ ì‘ë‹µí•˜ëŠ” ì—­í• í•¨
    -   ë™ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»´í¬ë„ŒíŠ¸
3.  MVC ëª¨ë¸ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬(Controller) ì—­í• ì„ í•¨
4.  ëª¨ë“  ë©”ì„œë“œëŠ” ìŠ¤ë ˆë“œë¡œ ë™ì‘í•¨
5.  HttpServlet í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ìŒ
    -   jakarta.servlet.http.HttpServlet

## ğŸ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ

1. ì„œë¸”ë¦¿ì„ ê´€ë¦¬í•˜ëŠ” ì»¨í…Œì´ë„ˆ (ìˆ˜ëª…ì£¼ê¸° ê´€ë¦¬)
    - (HTTP)ìš”ì²­
    - ìš”ì²­ ì „ë‹¬
    - ì„œë¸”ë¦¿ ë¡œë“œ
    - ì´ˆê¸°í™”
    - ìš”ì²­ ì²˜ë¦¬
    - (HTTP) ì‘ë‹µ
2. ë„¤íŠ¸ì›Œí¬ ì§€ì›
3. ë©€í‹°ìŠ¤ë ˆë”© ê´€ë¦¬
4. JSP ì§€ì›

## ğŸ ì„œë¸”ë¦¿ ë™ì‘ ë°©ì‹

1. Controller ì—­í• ì„ í•¨ (MVC íŒ¨í„´)
    - ìš”ì²­ ë°›ì•„ì„œ í•´ë‹¹ ìš”ì²­ ì²˜ë¦¬í•  ì„œë¸”ë¦¿ ì°¾ìŒ
    - ì„œë¹„ìŠ¤ ì¡°ì§ í˜¸ì¶œ
    - ëª¨ë¸(Model)ë¡œë¶€í„° ê·¸ ê²°ê³¼ê°’ì„ ë°›ì•„ì„œ ê²°ê³¼ê°’ì„ ì¶œë ¥í•  ë·°(View)ë¥¼ ì„ íƒí•¨

## ğŸ ì„œë¸”ë¦¿ ì‘ì„±

### 1ï¸âƒ£ web.xmlì— ê¸°ìˆ 

-   http://localhost:8080/HelloServlet/Servlet/helloServlet.do
-   í˜¸ìŠ¤íŠ¸ëª… / ì»¨í…ìŠ¤íŠ¸ë£¨íŠ¸ëª… / ìš”ì²­ëª…

     <details>
     <summary>  web.xml ì˜ˆì œ </summary>

    ```java
    package kr.co.kosta.servlet;

    import jakarta.servlet.ServletException;
    import jakarta.servlet.annotation.WebServlet;
    import jakarta.servlet.http.HttpServlet;
    import jakarta.servlet.http.HttpServletRequest;
    import jakarta.servlet.http.HttpServletResponse;
    import java.io.IOException;


    public class HelloServlet extends HttpServlet {
        private static final long serialVersionUID = 1L;


        public HelloServlet() {

        }


        protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        request.setAttribute("message", "Hello Servlet");
        request.getRequestDispatcher("/servlet/helloServlet.jsp").forward(request, response);
        }


        protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        }

    }

    ```

    ```jsp
    <%@ page language="java" contentType="text/html; charset=UTF-8"
        pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html>
    <head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    </head>
    <body>
        <h2>web.xmlì—ì„œ ë§¤í•‘ í›„ JSPì—ì„œ ì¶œë ¥í•˜ê¸°</h2>
        <p>
            <%= request.getAttribute("message") %>
            <br/>
            <a href ="./helloServlet.do">ë°”ë¡œê°€ê¸°</a>
        </p>
    </body>
    </html>
    ```

    </details>

### 2ï¸âƒ£ @WebsServletìœ¼ë¡œ ë§¤í•‘

![alt text](img/image3.png)

<details>
<summary>  @WebsServlet ì˜ˆì œ </summary>

    ```java
    package kr.co.kosta.servlet;

    import java.io.IOException;

    import jakarta.servlet.ServletException;
    import jakarta.servlet.annotation.WebServlet;
    import jakarta.servlet.http.HttpServlet;
    import jakarta.servlet.http.HttpServletRequest;
    import jakarta.servlet.http.HttpServletResponse;

    @WebServlet("/Servlet/annoMappingServlet.do")
    public class AnnoMappingServlet extends HttpServlet {

        @Override
        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

            req.setAttribute("message2", "@WebServletìœ¼ë¡œ ë§¤í•‘");
            req.getRequestDispatcher("/servlet/annoMapping.jsp").forward(req, resp);

        }
    }
    ```

    ```jsp
    <%@ page language="java" contentType="text/html; charset=UTF-8"
        pageEncoding="UTF-8"%>
    <!DOCTYPE html>
    <html>
    <head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    </head>
    <body>
    <h2>ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œ ë§¤í•‘í•˜ê¸°</h2>
        <p>
            <%= request.getAttribute("message2") %>
            <br/>
        </p>

    </body>
    </html>
    ```

</details>

### 3ï¸âƒ£ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì„±

<details>
<summary> í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ˆì œ</summary>

```java
package kr.co.kosta.servlet;

import java.io.IOException;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

// _.kostaë¡œ ëë‚˜ëŠ” ëª¨ë“  ìš”ì²­ì„ FrontController ì„œë¸”ë¦¿ì´ ì²˜ë¦¬
@WebServlet("_.kosta")
public class FrontController extends HttpServlet {
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {
String uri = request.getRequestURI();
// ë§ˆì§€ë§‰ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ìŠ¬ë˜ì‹œ /ì˜ ì¸ë±ìŠ¤ ë°˜í™˜
// /servlet/ -> 8
int lastSlash = uri.lastIndexOf("/");
// lastSlash ìœ„ì¹˜ë¶€í„° ë¬¸ìì—´ì˜ ëê¹Œì§€ë¥¼ ë°˜í™˜
String commandStr = uri.substring(lastSlash); // "/register.kosta"
if(commandStr.equals("/register.kosta"))
registFunc(request);
else if(commandStr.equals("/login.kosta"))
loginFunc(request);
else if(commandStr.equals("/board.kosta"))
boardFunc(request);
request.setAttribute("uri", uri);
request.setAttribute("commandStr", commandStr);
request.getRequestDispatcher("/servlet/frontController.jsp").forward(request, response);
}
private void boardFunc(HttpServletRequest request) {
request.setAttribute("resultValue", "<h4>ê²Œì‹œíŒ</h4>");
}

    public void loginFunc(HttpServletRequest request) {
    	request.setAttribute("resultValue", "<h4>ë¡œê·¸ì¸</h4>");
    }

    public void registFunc(HttpServletRequest request) {
    	request.setAttribute("resultValue", "<h4>íšŒì› ê°€ì…</h4>");
    }

}

```

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h3>ëª¨ë“  ìš”ì²­ì„ ë°›ì•„ ì²˜ë¦¬í•˜ê¸°</h3>
	${resultValue }
	<ol>
		<li>URI : ${uri }</li>
		<li>ìš”ì²­ëª… : ${commandStr }</li>
	</ol>
	<ul>
		<li><a href="../servlet/register.kosta">íšŒì›ê°€ì…</a></li>
		<li><a href="../servlet/login.kosta">ë¡œê·¸ì¸</a></li>
		<li><a href="../servlet/board.kosta">ê²Œì‹œíŒ</a></li>
	</ul>
</body>
</html>

```

</details>

> ê²°ê³¼ í™”ë©´

`http://localhost:8080/ServletTest/servlet/register.kosta`
![](img/image4.png)

`http://localhost:8080/ServletTest/servlet/login.kosta`

`http://localhost:8080/ServletTest/servlet/board.kosta`

## ğŸ ì„œë¸”ë¦¿ì˜ ìƒëª…ì£¼ê¸°(lifecycle) ë©”ì„œë“œ

1. í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ë¨¼ì € ì„œë¸”ë¦¿ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì„œë¸”ë¦¿ì„ ì´ˆê¸°í™”í•˜ê³ , ìš”ì²­ì„ ì²˜ë¦¬í•¨
2. ì„œë²„ë¥¼ ì¢…ë£Œí•  ë•Œ ì„œë¸”ë¦¿ ê°ì²´ ì†Œë©¸ì‹œí‚´
3. ì„œë¸”ë¦¿ì˜ ìˆ˜ëª…ì£¼ê¸° ê´€ë¦¬ëŠ” ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ë‹´ë‹¹í•¨
    - ì„œë¸”ë¦¿ ê°ì²´ ìƒì„± => @PostConstruct (ì „ì²˜ë¦¬) => init()
      service()
      doGet(), doPost()
      destroy() => @PreDestroy (í›„ì²˜ë¦¬)ì„œë¸”ë¦¿ì˜ ìƒëª…ì£¼ê¸°(lifecycle) ë©”ì„œë“œ

### ğŸ‘ ì„œë¸”ë¦¿ lifecycle ì˜ˆì œ

> url : `http://localhost:8080/ServletTest/servlet/lifeCycle.do`

![](img/image5.png)

<details>
<summary>ì„œë¸”ë¦¿ì˜ ìƒëª…ì£¼ê¸°(lifecycle) ì˜ˆì œ ì½”ë“œ </summary>

```java
package kr.co.kosta.servlet;

import java.io.IOException;

import jakarta.annotation.PostConstruct;
import jakarta.annotation.PreDestroy;
import jakarta.security.auth.message.callback.PrivateKeyCallback.Request;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

@WebServlet("/servlet/lifeCycle.do")
public class LifeCycle extends HttpServlet {

	@PostConstruct
	public void myPostConstruct() {
		System.out.println("@PostConstruct (ì „ì²˜ë¦¬) í˜¸ì¶œ");
	}

	@Override
	public void init() throws ServletException {
		System.out.println("init() í˜¸ì¶œ");
	}

//	@Override
//	protected void service(HttpServletRequest request, HttpServletResponse response)
//			throws ServletException, IOException {
//		System.out.println("service() í˜¸ì¶œ");
//		request.getRequestDispatcher("/servlet/lifeCycle.jsp").forward(request, response);
//	}

	@Override
	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		System.out.println("doGet() í˜¸ì¶œ");
		request.getRequestDispatcher("/servlet/lifeCycle.jsp").forward(request, response);
	}

	@Override
	protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		System.out.println("doPost() í˜¸ì¶œ");
		request.getRequestDispatcher("/servlet/lifeCycle.jsp").forward(request, response);
	}

	@Override
	public void destroy() {
		System.out.println("destory() í˜¸ì¶œ");
	}

	@PreDestroy
	public void myPreDestroy() {
		System.out.println("@PreDestroy (í›„ì²˜ë¦¬) í˜¸ì¶œ");
	}
}

```

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<script	type="text/javascript">
		function requestAction(frm, met) {
			if (met == 1)
				frm.method = 'get'
			else
				frm.method = 'post'
			frm.submit()
		}
	</script>

	<h2>ì„œë¸”ë¦¿ ìˆ˜ëª…ì£¼ê¸°(Life Cycle)</h2>
	<form action="./lifeCycle.do">
		<input type="button" value="Get ë°©ì‹ ìš”ì²­" onclick="requestAction(this.form, 1)" />
		<input type="button" value="Post ë°©ì‹ ìš”ì²­" onclick="requestAction(this.form, 2)" />
	</form>
</body>
</html>
```

</details>
