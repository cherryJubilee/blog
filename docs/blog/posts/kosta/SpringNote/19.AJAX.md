---
draft: false
authors:
    - hyewon
date: 2024-09-02
categories:
    - spring
---

# AJAX

-   Javascript Object Notation (ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´ í‘œê¸°ë²•)
-   JSON.stringify(), JSON.parse()
-   @RestController = @RequestBody, @Controller

<!-- more -->

## ğŸ“Œ JSON

### JSON ë°°ì—´

-   [ {}, {}, {} ]ì²˜ëŸ¼ ê°ì²´ì˜ ë°°ì—´ë¡œ í‘œí˜„

    ```json
    [
        {
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "ì†ì„±ëª…": "ì†ì„±ê°’"
        },
        {
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "ì†ì„±ëª…": "ì†ì„±ê°’",
            "hobby": "ì†ì„±ê°’"
        }
    ]
    ```

### JSON ê°ì²´

-   { "key1": {}, "key2": {} }ì²˜ëŸ¼ í‚¤-ê°’ ìŒìœ¼ë¡œ í‘œí˜„

    ```json
    {
        "í‚¤1": {
            "ì†ì„±ëª…1": "ì†ì„±ê°’1",
            "ì†ì„±ëª…2": "ì†ì„±ê°’2",
            "ì†ì„±ëª…3": "ì†ì„±ê°’3",
            "ì†ì„±ëª…4": "ì†ì„±ê°’4"
        },
        "í‚¤2": {
            "ì†ì„±ëª…1": "ì†ì„±ê°’1",
            "ì†ì„±ëª…2": "ì†ì„±ê°’2",
            "ì†ì„±ëª…3": "ì†ì„±ê°’3",
            "hobby": "ì†ì„±ê°’"
        }
    }
    ```

### JSON.stringify(), JSON.parse()

-   client sideì—ì„œì˜ ì´ì•¼ê¸°ì´ë‹¤.
-   `JSON.stringify()`
    -   JS ê°ì²´ë¥¼ ì„œë²„ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ì„œ ì§ë ¬í™”(ë¬¸ìì—´ë¡œ ë³€í™˜)ê°€ í•„ìš”
    -   ê°ì²´ë¥¼
    -   {name : í™ê¸¸ë™, age : 30} -> "{"name" : "í™ê¸¸ë™", "age" : "30"}"
-   `JSON.parse()`
    -   ì„œë²„ê°€ ë³´ë‚¸ ë°ì´í„°(JSON ë¬¸ìì—´)ì„ JS ê°ì²´ë¡œ ë³€í™˜ì´ í•„ìš”. ì—­ì§ë ¬í™”
    -   {name : í™ê¸¸ë™, age : 30} <- "{"name" : "í™ê¸¸ë™", "age" : "30"}"
    -   ì„œë²„ë¡œë¶€í„° ë°ì´í„°ë¥¼

### jackson-databind

-   server sideì—ì„œì˜ ì´ì•¼ê¸°
-   jsonë¬¸ìì—´ë¡œ ìë°”ì—ì„œ ë°›ì•„ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ JAVA ê°ì²´ë¡œ ë³€í™˜í•´ì£¼ëŠ” ê¸°ëŠ¥
-   JAVA ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì´ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

## ğŸ“Œ jQueryë¥¼ ì´ìš©í•œ AJAX

```ajax
$.ajax({
    type: post ë˜ëŠ” get,
    ascync : "true" or "false",
    url: "ìš”ì²­í•  URL",
    data: {ì„œë²„ë¡œ ë³´ë‚¼ ë°ì´í„°},
    dataType : "text ì„œë²„ì—ì„œ ì „ì†¡ë°›ì„ ë°ì´í„° í˜•ì‹",
    success: {
        // ì •ìƒ ìš”ì²­, ì‘ë‹µ ì‹œ ì²˜ë¦¬
    },
    error : {
        // ì˜¤ë¥˜ ë°œìƒì‹œ ì²˜ë¦¬
    } ,
    complete : {
        // ì‘ì—… ì™„ë£Œ í›„ ì²˜ë¦¬
    }
```

## ğŸ“Œ ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜(@RequestBody, @Controller)

### @RequestBody

-   HTTP Request Message Body ë¥¼ í†µí•´ ì „ë‹¬ëœ ë°ì´í„°ë¥¼ ì§€ì •í•œ ê°ì²´ë¡œ deserialize
    -   JSON í˜•íƒœì˜ ë°ì´í„°ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©

### @Controller

-   Viewë¥¼ ë°˜í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë¨
-   @RequestBody ì–´ë…¸í…Œì´ì…˜ í™œìš©
    -   Dataë¥¼ ë°˜í™˜í•  ë•Œ ì‚¬ìš© (JSON)
    -   ë°˜í™˜ë˜ëŠ” ê°ì²´ê°€ JSONìœ¼ë¡œ serialized ë˜ì–´ ë°˜í™˜ë¨

### @RestController

-   @RequestBody + @Controller
-   ì£¼ëª©ì ì€ JSON í˜•íƒœì˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒ

## ğŸ“Œ AJAX ìš”ì²­ê³¼ ì‘ë‹µ ê³¼ì •

![alt text](image.png)

```java
@Controller
public class SimpleRestController {

	@GetMapping("/ajax")
	public String  ajax() {
		return "ajax";
	}

	@ResponseBody
	@PostMapping("/send")
		public Person test(@RequestBody Person p) {
			System.out.println("p = " +  p);
			p.setName("kosta 0902");
			p.setAge(38);
			return p;
		}
	}

```

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>


<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="<c:url value='/resources/css/menu.css' />" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" />
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<title>Insert title here</title>
</head>
<body>
	<h2>{name : "kosta", age : 31}</h2>
	<button id="sentBtn" type="button">SEND</button>

	<h2>Data from server</h2>
	<div id="data"></div>

	<script type="text/javascript">
	$(document).ready(function) {
		let person = {name : "kosta", age : 28}
		let person2 = {}
		$("#sendBtn").click(function() {

			$ajax({
				type : "POST",
				url : '/october/send',
				headers: {"Content-Type": "application/json"},
				data: JSON.stringify(person),
				dataType : "text",
				success: function(result) {
			        person2 = JSON.parse(result);
			        alert("received: " + result);
			        $("#data").html("name = " + person2.name + " age = " + person2.age);
			    },
			    error: function() {
			        alert("error");
			    }
			})

			alert("this request is sent")
		})
	}
	</script>
</body>
</html>
```

## RestController

-   representational state transfer
-   ì›¹ì„œë¹„ìŠ¤ ë””ìì¸ ì•„í‚¤í…ì²˜ ì ‘ê·¼ ë°©ì‹
-   í”„ë¡œí† ì½œì— ë…ë¦½ì ì„, ì£¼ë¡œ HTTPë¥¼ ì‚¬ìš©í•´ì„œ êµ¬í˜„
    -   REST ê·œì•½ì„ ì¤€ìˆ˜í•˜ëŠ” API
-   ë¦¬ì†ŒìŠ¤ ì¤‘ì‹¬ì˜ API ë””ìì¸
-   HTTP ë©”ì†Œë“œë¡œ ì‚¬ìš©í•  ì‘ì—…ì„ ì •ì˜

| ë¦¬ì†ŒìŠ¤              | POST                        | GET                            | PUT                                     | DELETE         | UPDATE |
| ------------------- | --------------------------- | ------------------------------ | --------------------------------------- | -------------- | ------ |
| /products           | ìƒˆë¬¼ê±´ ë§Œë“¤ê¸°               | ëª¨ë“  ë¬¼ê±´ ê²€ìƒ‰                 | ë¬¼ê±´ ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸                      | ëª¨ë“  ë¬¼ê±´ ì‚­ì œ |        |
| /products/821       | ERROR                       | ë¬¼ê±´ 821ì— ëŒ€í•œ ì •ë³´ ê²€ìƒ‰      | ë¬¼ê±´ 821ì´ ìˆëŠ” ê²½ìš° ì„¸ë¶€ ì •ë³´ ì—…ë°ì´íŠ¸ | ëª¨ë“  ë¬¼ê±´ 821  |        |
| /products/821/order | ë¬¼ê±´ 821ì— ëŒ€í•œ ì£¼ë¬¸ ë§Œë“¤ê¸° | ë¬¼ê±´ 821ì— ëŒ€í•œ ëª¨ë“  ì£¼ë¬¸ ê²€ìƒ‰ | ë¬¼ê±´ 821ì— ì£¼ë¬¸ ëŒ€ëŸ‰ ì—…ë°ì´íŠ¸           | ë¬¼ê±´ 821 ì‚­ì œ  |        |

### RESTful API ì„¤ê³„ ë° ë¹„êµ

> ê¸°ì¡´ api

| ì‘ì—… | URI                     | HTTP Method | ì„¤ëª…                      |
| ---- | ----------------------- | ----------- | ------------------------- |
| ì½ê¸° | /products/read?cno=ë²ˆí˜¸ | GET         | ì§€ì •ëœ ë²ˆí˜¸ì˜ ê¸€ì„ ë³´ì—¬ì¤Œ |
| ì“°ê¸° | /products/write         | POST        | ì‘ì„±í•œ ë¬¼ê±´ ì €ì¥          |
| ì‚­ì œ | /products/remove        | POST        | ë¬¼ê±´ ì‚­ì œ                 |
| ìˆ˜ì • | /products/modify        | POST        | ìˆ˜ì •ëœ ë¬¼ê±´ì„ ìˆ˜ì •í•¨      |

> REST API

| ì‘ì—… | URI             | HTTP Method | ì„¤ëª…                      |
| ---- | --------------- | ----------- | ------------------------- |
| ì½ê¸° | /products       | GET         | ëª¨ë“ ê¸€ì„ ë³´ì—¬ì¤Œ           |
| ì½ê¸° | /products/{cno} | GET         | ì§€ì •ëœ ë²ˆí˜¸ì˜ ê¸€ì„ ë³´ì—¬ì¤Œ |
| ì“°ê¸° | /products       | POST        | ìƒˆë¡œìš´ ë¬¼ê±´ ì €ì¥          |
| ì‚­ì œ | /products/{cno} | DELETE      | ë¬¼ê±´ ì‚­ì œ                 |
| ìˆ˜ì • | /products/{cno} | PUT/PATCH   | ìˆ˜ì •ëœ ë¬¼ê±´ì„ ì €ì¥í•¨      |
